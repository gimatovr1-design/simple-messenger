<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Simple Messenger</title>

<style>
* { box-sizing: border-box; }

body {
    margin: 0;
    height: 100vh;
    background: radial-gradient(circle at top, #1a2a3a, #050b12);
    display: flex;
    justify-content: center;
    align-items: center;
    font-family: Arial, sans-serif;
    color: #fff;
}

.chat {
    width: 820px;
    height: 520px;
    display: flex;
    background: rgba(10,15,20,0.85);
    border-radius: 12px;
    overflow: hidden;
    box-shadow: 0 0 40px rgba(0,255,255,0.15);
}

/* ===== ĞĞ½Ğ»Ğ°Ğ¹Ğ½ ===== */
.sidebar {
    width: 200px;
    background: rgba(0,0,0,0.35);
    padding: 10px;
}

.sidebar h3 {
    margin: 0 0 10px;
    font-size: 14px;
}

.user {
    display: flex;
    align-items: center;
    gap: 8px;
    margin-bottom: 6px;
    font-size: 14px;
}

.dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #00ff88;
}

/* ===== Ğ§Ğ°Ñ‚ ===== */
.main {
    flex: 1;
    display: flex;
    flex-direction: column;
}

.messages {
    flex: 1;
    padding: 12px;
    overflow-y: auto;
}

.msg {
    max-width: 60%;
    padding: 8px 10px;
    margin-bottom: 8px;
    border-radius: 10px;
    word-wrap: break-word;
}

.me {
    background: linear-gradient(135deg, #7f5af0, #9d4edd);
    margin-left: auto;
}

.other {
    background: rgba(255,255,255,0.15);
    margin-right: auto;
}

.nick {
    font-size: 11px;
    opacity: 0.7;
    margin-bottom: 2px;
}

/* ===== Ğ’Ğ²Ğ¾Ğ´ ===== */
.input {
    display: flex;
    gap: 6px;
    padding: 10px;
    background: rgba(0,0,0,0.35);
}

.input input[type="text"] {
    flex: 1;
    padding: 8px;
    border-radius: 6px;
    border: none;
    outline: none;
}

.btn {
    width: 38px;
    border-radius: 6px;
    border: none;
    cursor: pointer;
    background: #1f2937;
    color: #fff;
    font-size: 18px;
}

.send {
    width: 90px;
    background: #2563eb;
}

/* ===== Ğ­Ğ¼Ğ¾Ğ´Ğ·Ğ¸ ===== */
.emoji-panel {
    position: absolute;
    bottom: 70px;
    right: 260px;
    background: #111;
    border-radius: 8px;
    padding: 8px;
    display: none;
    flex-wrap: wrap;
    width: 200px;
}

.emoji-panel span {
    cursor: pointer;
    font-size: 20px;
    margin: 4px;
}
</style>
</head>
<body>

<div class="chat">
    <div class="sidebar">
        <h3>ĞĞ½Ğ»Ğ°Ğ¹Ğ½</h3>
        <div id="users"></div>
    </div>

    <div class="main">
        <div class="messages" id="messages"></div>

        <div class="input">
            <button class="btn" id="emojiBtn">ğŸ˜€</button>
            <button class="btn" id="fileBtn">ğŸ“</button>
            <input type="file" id="fileInput" hidden>
            <input type="text" id="text" placeholder="Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ">
            <button class="btn send" id="send">ĞÑ‚Ğ¿Ñ€Ğ°Ğ²Ğ¸Ñ‚ÑŒ</button>
        </div>
    </div>
</div>

<div class="emoji-panel" id="emojiPanel">
    ğŸ˜€ ğŸ˜ ğŸ˜‚ ğŸ¤£ ğŸ˜ ğŸ˜ ğŸ¤– ğŸ”¥ ğŸš€ ğŸ’œ ğŸ‘ ğŸ‘€ ğŸ˜¡ ğŸ˜¢ ğŸ‰
</div>

<script>
let ws = new WebSocket(
    (location.protocol === "https:" ? "wss://" : "ws://") + location.host + "/ws"
);

let nick = null;

while (!nick) nick = prompt("Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ Ğ½Ğ¸Ğº");

ws.onopen = () => {
    ws.send(JSON.stringify({type:"nick", nick}));
};

ws.onmessage = e => {
    let data = JSON.parse(e.data);

    if (data.type === "users") {
        users.innerHTML = "";
        data.users.forEach(u => {
            let d = document.createElement("div");
            d.className = "user";
            d.innerHTML = `<span class="dot"></span>${u}`;
            users.appendChild(d);
        });
    }

    if (data.type === "message") {
        let div = document.createElement("div");
        div.className = "msg " + (data.nick === nick ? "me" : "other");
        div.innerHTML = `<div class="nick">${data.nick}</div>${data.text}`;
        messages.appendChild(div);
        messages.scrollTop = messages.scrollHeight;
    }
};

send.onclick = sendMsg;
text.onkeydown = e => e.key === "Enter" && sendMsg();

function sendMsg() {
    if (!text.value) return;
    ws.send(JSON.stringify({type:"message", text:text.value}));
    text.value = "";
}

/* ===== Ğ­Ğ¼Ğ¾Ğ´Ğ·Ğ¸ ===== */
emojiBtn.onclick = () => {
    emojiPanel.style.display =
        emojiPanel.style.display === "flex" ? "none" : "flex";
};

emojiPanel.onclick = e => {
    if (e.target.tagName === "SPAN") text.value += e.target.textContent;
};

/* ===== Ğ¤Ğ°Ğ¹Ğ» (Ğ¿Ğ¾ĞºĞ° UI, Ğ±ĞµĞ· ÑĞµÑ€Ğ²ĞµÑ€Ğ°) ===== */
fileBtn.onclick = () => fileInput.click();
fileInput.onchange = () => {
    alert("Ğ¤Ğ°Ğ¹Ğ» Ğ²Ñ‹Ğ±Ñ€Ğ°Ğ½: " + fileInput.files[0].name);
};
</script>

</body>
</html>
