<!DOCTYPE html>
<html lang="ru">
<head>
<meta charset="UTF-8">
<title>Mini Chat</title>
<link rel="icon" href="/favicon.ico">

<style>
body {
  background:#020617;
  color:white;
  font-family:system-ui, sans-serif;
  display:flex;
  justify-content:center;
  align-items:center;
  height:100vh;
  margin:0;
}

/* Контейнер чата */
#chat {
  width:320px;
  background:#020617;
  border:1px solid #1e293b;
  border-radius:12px;
  box-shadow:0 0 20px rgba(0,0,0,.6);
  overflow:hidden;
}

/* Шапка */
#header {
  display:flex;
  align-items:center;
  gap:8px;
  padding:10px;
  border-bottom:1px solid #1e293b;
  background:#020617;
}

/* Зеленая точка */
#status {
  width:10px;
  height:10px;
  background:#22c55e;
  border-radius:50%;
  box-shadow:0 0 6px #22c55e;
}

/* Сообщения */
#messages {
  height:200px;
  overflow-y:auto;
  padding:10px;
  font-size:14px;
}

.msg {
  margin-bottom:6px;
  word-wrap:break-word;
}

/* Поле ввода */
#inputBox {
  display:flex;
  border-top:1px solid #1e293b;
}

#msg {
  flex:1;
  padding:8px;
  background:#020617;
  color:white;
  border:none;
  outline:none;
}
</style>
</head>
<body>

<div id="chat">
  <div id="header">
    <div id="status"></div>
    <div>В сети</div>
  </div>

  <div id="messages"></div>

  <div id="inputBox">
    <input id="msg" placeholder="Сообщение..." autocomplete="off">
  </div>
</div>

<script>
const nickname = prompt("Введите ник:");
const protocol = location.protocol === "https:" ? "wss" : "ws";
const ws = new WebSocket(`${protocol}://${location.host}/ws`);

ws.onopen = () => {
    ws.send(nickname);
};

ws.onmessage = (e) => {
    const div = document.createElement("div");
    div.className = "msg";
    div.textContent = e.data;
    const box = document.getElementById("messages");
    box.appendChild(div);
    box.scrollTop = box.scrollHeight;
};

document.getElementById("msg").addEventListener("keydown", e => {
    if (e.key === "Enter" && e.target.value.trim()) {
        ws.send(e.target.value);
        e.target.value = "";
    }
});
</script>

</body>
</html>
